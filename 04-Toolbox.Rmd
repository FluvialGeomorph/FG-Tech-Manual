# Toolbox
This chapter describes the FluvialGeomorph toolbox structure and the products it creates. This chapter begins with a description of the platforms used, the structure of the FluvialGeomorph ArcGIS toolbox and concludes with a description of the products created. 


## Platforms
The FluvialGeomorph toolbox uses [ESRI](https://www.esri.com/en-us/home) and open source software to combine several platforms, each chosen based on their strengths, to construct a custom toolbox for rapid fluvial geomorphology analysis. 

* [ArcGIS Desktop](https://desktop.arcgis.com/en/) -Desktop (ArcMap and ArcGIS Pro) are industry standard enterprise desktop GIS products for conducting geospatial analysis. The ArcGIS desktop applications contain an enormous number of commercial-off-the shelf (COTS) geospatial tools for performing sophisticated analyses and visualization. 
* [ArcGIS toolbox](https://pro.arcgis.com/en/pro-app/latest/help/analysis/geoprocessing/basics/use-a-custom-geoprocessing-tool.htm) - ArcGIS Desktop allows for the creation of sophisticated custom geospatial toolboxes to be built that combine ESRI's COTS geoprocessing tools with user created tools from several platforms (e.g., Python, R). 
* [Python](https://www.python.org/) - ArcGIS provides a robust scripting interface to its GIS tools using the Python language. Custom geospatial toolboxes can combine ESRI's COTS geoprocessing tools with tools available within the diverse, mature, and ever-growing Python data science ecosystem. 
* [R](https://cran.r-project.org/) - ESRI's [ArcGIS R-bridge](https://github.com/R-ArcGIS/r-bridge) product allows R tools to be called within the ArcGIS toolbox interface. This allows ArcGIS tools to take advantage of the mature ecosystem of R data science, statistical, visualization, and report generation packages. 


## Packages
The FluvialGeomorph toolbox is composed of a set of tightly connected packages that work together to complete the analysis. Modular design was a conscious architectural decision made to take advantage of the best tools and to help support long-term maintenance. Links are provided below to each package's online code repository. 

* The [`FluvialGeomorph`](https://github.com/FluvialGeomorph/FluvialGeomorph-toolbox) toolbox - This is the primary user-facing software component. It is an ArcGIS toolbox organized as a Python package. The custom Python tools in this toolbox perform primarily geospatial operations, where the ESRI platform excels (e.g., linear referencing). It also performs the installation of the needed R packages. 
* The [`fluvgeo`](https://github.com/FluvialGeomorph/fluvgeo) R package - This custom R package developed for this project contains the bulk of the data science, statistical, visualization, and reporting functions, where the R platform excels. 
* The [`RegionalCurve`](https://github.com/FluvialGeomorph/RegionalCurve) R package - This custom R package developed for this project contains the data and functions for accessing regional hydraulic geometry studies. 


## ArcGIS Toolbox
The FluvialGeomorph toolbox contains a set of tools for analyzing streams. These tools are divided into four toolsets. 

### 01 - Install toolset
The purpose of this toolset is to hold the tools needed to install and troubleshoot the FluvialGeomorph toolbox software components. 

#### `Install R Packages`
**Purpose** - This tool installs the R packages required by the FluvialGeomorph toolbox. This tool also sets several configuration settings. 

**Code** - This ArcGIS script tool calls the R script [`FluvialGeomorph-toolbox/install/Install_FG_R.R`](https://github.com/FluvialGeomorph/FluvialGeomorph-toolbox/blob/master/install/Install_FG_R.R). 

#### `R Session Info`
**Purpose** - This tool provides the output of the current R session. This is helpful for troubleshooting R environment issues during installation. 

**Code** - This ArcGIS script tool calls the R script [`FluvialGeomorph-toolbox/install/session.R`](https://github.com/FluvialGeomorph/FluvialGeomorph-toolbox/blob/master/install/session.R). 


### 02 - Tools toolset
The purpose of this toolset is to hold the tools that perform the FluvialGeomorph analysis. 

#### `02 - Hydro DEM`
**Purpose** - This tool "burns" (sets the elevation to the same value for all pixels along the extent of the polyline feature) a [`cutlines`](#cutlines) feature class into the supplied DEM and creates the [`dem_hydro`](hydro-modified-raster) in the output workspace. 

**Code** - This ArcGIS script tool calls the Python script [`FluvialGeomorph-toolbox/tools/_02_HydroDEM.py`](https://github.com/FluvialGeomorph/FluvialGeomorph-toolbox/blob/master/tools/_02_HydroDEM.py)

**Parameters** - This tool contains the following parameters:
```{r, echo=FALSE}
params_table(params_df, "hydro_dem", "Hydro DEM Tool Parameters.")
```

```{r echo=FALSE, fig.cap="02 - Hydro DEM Tool Dialog."}
knitr::include_graphics("figures/toolbox/tool_Hydro_DEM.png")
```

#### `03 - Contributing Area`
**Purpose** - This tool calculates the contributing area from an input DEM. 

**Code** - This ArcGIS script tool calls the Python script [`FluvialGeomorph-toolbox/tools/_03_ContributingArea.py`](https://github.com/FluvialGeomorph/FluvialGeomorph-toolbox/blob/master/tools/_03_ContributingArea.py). This Python script uses the [TauDEM](https://hydrology.usu.edu/taudem/taudem5/index.html) [D-Infinity Contributing Area tool](https://hydrology.usu.edu/taudem/taudem5/help53/DInfinityContributingArea.html) to calculate the specific catchment area (which is the contributing area per unit contour length using the multiple flow direction D-infinity approach).

**Parameters** - This tool contains the following parameters:
```{r, echo=FALSE}
params_table(params_df, "contributing_area", "Contributing Area Tool Parameters.")
```

```{r echo=FALSE, fig.cap="03 - Contributing Area Tool."}
knitr::include_graphics("figures/toolbox/tool_Contributing_Area.png")
```

#### `03a - Contributing Area D8`
**Purpose** - This tool calculates D8 flow accumulation and flow direction rasters from an input DEM. 

**Code** - This ArcGIS script tool calls the Python script [`FluvialGeomorph-toolbox/tools/_03a_ContributingAreaD8.py`](https://github.com/FluvialGeomorph/FluvialGeomorph-toolbox/blob/master/tools/_03a_ContributingAreaD8.py). 

**Parameters** - This tool contains the following parameters:
```{r, echo=FALSE}
params_table(params_df, "contributing_area_D8", "Contributing Area D8 Tool Parameters.")
```

```{r echo=FALSE, fig.cap="03a - Contributing Area D8 Tool."}
knitr::include_graphics("figures/toolbox/tool_Contributing_Area_D8.png")
```

#### `04 - Stream Network`
**Purpose** - This tool creates a synthetic flow network from a contributing area raster and a stream initiation threshold. 

**Code** - The ArcGIS script tool calls the Python script [`FluvialGeomorph-toolbox/tools/_04_StreamNetwork.py`](https://github.com/FluvialGeomorph/FluvialGeomorph-toolbox/blob/master/tools/_04_StreamNetwork.py). 

**Parameters** - This tool contains the following parameters:
```{r, echo=FALSE}
params_table(params_df, "stream_network", "Stream Network Tool Parameters.")
```

```{r echo=FALSE, fig.cap="04 - Stream Network Tool."}
knitr::include_graphics("figures/toolbox/tool_Stream_Network.png")
```

#### `04a - Stream Network Points`
**Purpose** - This tool converts a stream network to points and calculates the drainage area. 

**Code** - This ArcGIS script tool calls the Python script [`FluvialGeomorph-toolbox/tools/_04a_StreamNetworkPoints.py`](https://github.com/FluvialGeomorph/FluvialGeomorph-toolbox/blob/master/tools/_04a_StreamNetworkPoints.py). 

**Parameters** - This tool contains the following parameters:
```{r, echo=FALSE}
params_table(params_df, "stream_network_points", "Stream Network Points Tool Parameters.")
```

```{r echo=FALSE, fig.cap="04a - Stream Network Point Tool."}
knitr::include_graphics("figures/toolbox/tool_Stream_Network_Points.png")
```

#### `04b - Slope and Sinuosity`
**Purpose** - This tool calculates stream gradient (or slope) and sinuosity for a [`flowline_points`](#flowline-points) or [`stream_network`](#stream-network) feature class. 

**Code** - This ArcGIS script tool calls the Python script [`FluvialGeomorph-toolbox/tools/_04b_Gradient.R`](https://github.com/FluvialGeomorph/FluvialGeomorph-toolbox/blob/master/tools/_04b_Gradient.R). 

**Parameters** - This tool contains the following parameters:
```{r, echo=FALSE}
params_table(params_df, "stream_network_points", "Stream Network Points Tool Parameters.")
```

```{r echo=FALSE, fig.cap="04b - Slope and Sinuosity Tool."}
knitr::include_graphics("figures/toolbox/tool_Slope_and_Sinuosity.png")
```

#### `04c - Watershed`
**Purpose** - This tool calculates the watershed for each input point. 

**Code** - This ArcGIS script tool calls the Python script  [`FluvialGeomorph-toolbox/tools/_04c_Watersheds.py`](https://github.com/FluvialGeomorph/FluvialGeomorph-toolbox/blob/master/tools/_04c_Watersheds.py). 

**Parameters** - This tool contains the following parameters:
```{r, echo=FALSE}
params_table(params_df, "watershed", "Watershed Tool Parameters.")
```

```{r echo=FALSE, fig.cap="04c - Watershed Tool."}
knitr::include_graphics("figures/toolbox/tool_Watershed.png")
```

#### `05 - Flowline`
This tool creates a [`flowline`](#flowline) feature class from an edited `stream_network` feature class. This ArcGIS script tool calls the Python script [`FluvialGeomorph-toolbox/tools/_05_Flowline.py`](https://github.com/FluvialGeomorph/FluvialGeomorph-toolbox/blob/master/tools/_05_Flowline.py). 

```{r echo=FALSE, fig.cap="05 - Flowline Tool."}
knitr::include_graphics("figures/toolbox/tool_Flowline.png")
```

#### `06 - Flowline Points`
This tool converts a stream [`flowline`](#flowline) feature class to a route using the distance to mouth parameter and creates a [`flowline_points`](#flowline-points) feature class. This ArcGIS script tool calls the Python script  [`FluvialGeomorph-toolbox/tools/_06_FlowlinePoints.py`](https://github.com/FluvialGeomorph/FluvialGeomorph-toolbox/blob/master/tools/_06_FlowlinePoints.py). 

```{r echo=FALSE, fig.cap="06 - Flowline Points Tool."}
knitr::include_graphics("figures/toolbox/tool_Flowline_Points.png")
```

#### `07 - Detrend DEM`
This tool creates the [`detrend`](detrended-raster) raster, a detrended DEM. This ArcGIS script tool calls the Python script [`FluvialGeomorph-toolbox/tools/_07_DetrendDEM.py`](https://github.com/FluvialGeomorph/FluvialGeomorph-toolbox/blob/master/tools/_07_DetrendDEM.py). 

```{r echo=FALSE, fig.cap="07 - Detrend Tool."}
knitr::include_graphics("figures/toolbox/tool_Detrend_DEM.png")
```

#### `08 - Water Surface Extent`

```{r echo=FALSE, fig.cap="08 - Water Surface Extent Tool."}
knitr::include_graphics("figures/toolbox/tool_Water_Surface_Extent.png")
```

#### `09 - Channel Slope`

```{r echo=FALSE, fig.cap="09 - Channel Slope Tool."}
knitr::include_graphics("figures/toolbox/tool_Channel_Slope.png")
```

#### `10 - Centerline`

```{r echo=FALSE, fig.cap="10 - Centerline Tool."}
knitr::include_graphics("figures/toolbox/tool_Centerline.png")
```

#### `11 - XS Layout`

```{r echo=FALSE, fig.cap="11 - XS Layout Tool."}
knitr::include_graphics("figures/toolbox/tool_XS_Layout.png")
```

#### `12 - XS Watershed Area`

```{r echo=FALSE, fig.cap="12 - XS Watershed Area Tool."}
knitr::include_graphics("figures/toolbox/tool_XS_Watershed_Area.png")
```

#### `13 - XS River Position`

```{r echo=FALSE, fig.cap="13 - XS River Position Tool."}
knitr::include_graphics("figures/toolbox/tool_XS_River_Position.png")
```

#### `13a - XS Resequence`

```{r echo=FALSE, fig.cap="13a - XS Resequence Tool."}
knitr::include_graphics("figures/toolbox/tool_XS_Resequence.png")
```

#### `14 - XS Points`

```{r echo=FALSE, fig.cap="14 - XS Points Tool."}
knitr::include_graphics("figures/toolbox/tool_XS_Points.png")
```

#### `14b - Bankline Points`

```{r echo=FALSE, fig.cap="14b - Bankline Points Tool."}
knitr::include_graphics("figures/toolbox/tool_Bankline_Points.png")
```

#### `14c - XS Assign Loops`

```{r echo=FALSE, fig.cap="14c - XS Assign Loops Tool."}
knitr::include_graphics("figures/toolbox/tool_XS_Assign_Loops.png")
```

#### `15a - XS Dimensions, Level 1` 

```{r echo=FALSE, fig.cap="15a - XS Dimensions, Level 1 Tool."}
knitr::include_graphics("figures/toolbox/tool_XS_Dimensions_L1.png")
```

#### `15b - XS Dimensions, Level 2`

```{r echo=FALSE, fig.cap="15b - XS Dimensions, Level 2 Tool."}
knitr::include_graphics("figures/toolbox/tool_XS_Dimensions_L2.png")
```

#### `15c - XS Planform, Level 3`
**Purpose** - This tool creates the Level 3 Dimensions. 

**Code** - This ArcGIS script tool calls the Python script [`FluvialGeomorph/FluvialGeomorph-toolbox/tools/_15c_XSPlanform.R`](https://github.com/FluvialGeomorph/FluvialGeomorph-toolbox/blob/master/tools/_15c_XSPlanform.R) which calls the functions [`fluvgeo::planform_dimensions`](https://github.com/FluvialGeomorph/fluvgeo/blob/master/R/planform_dimensions.R) to calculate the planform dimensions and [`fluvgeo::xs_metric_ratios`](https://github.com/FluvialGeomorph/fluvgeo/blob/master/R/xs_metric_ratios.R) to calculate the metric ratios. 

```{r echo=FALSE, fig.cap="15b - XS Dimensions, Level 3 Tool."}
knitr::include_graphics("figures/toolbox/tool_XS_Dimensions_L3.png")
```

#### `16 - XS RAS Watersurface`

```{r echo=FALSE, fig.cap="16 - XS RAS Watersurface Tool."}
knitr::include_graphics("figures/toolbox/tool_XS_RAS_Watersurface.png")
```

### 03 - Reports toolset
The purpose of this toolset is to hold the tools that produce the FluvialGeomorph reports. 

#### `Graph - Longitudinal Profile Compare`
The purpose of this tool is to compare longitudinal profile plots from multiple surveys. This tool produces a longitudinal profile plot from the [`flowline_points`](#flowline-points) feature classes of a stream reach taken from one or more surveys. It labels the plot using the [`features`](#features) feature class along the x-axis. This ArcGIS script tool calls the R script [`FluvialGeomorph-toolbox\report\_Longitudinal_Profile_Compare.R`](https://github.com/FluvialGeomorph/FluvialGeomorph-toolbox/blob/master/report/_Longitudinal_Profile_Compare.R) which calls the function  [`fluvgeo::compare_long_profile`](https://github.com/FluvialGeomorph/fluvgeo/blob/master/R/compare_long_profile.R). 

```{r echo=FALSE, fig.cap="Graph - Longitudinal Profile Compare Tool."}
knitr::include_graphics("figures/toolbox/tool_Graph-Longitudinal_Profile_Compare.png")
```

#### `Graph - Longitudinal XS Profile Comapre`

#### `Map - Reach Overview`

```{r echo=FALSE, fig.cap="Map - Reach Overview Tool."}
knitr::include_graphics("figures/toolbox/tool_Map-Reach_Overview.png")
```

#### `Report - L1`
The purpose of this tool is produce the Level 1 report. This ArcGIS script tool 

```{r echo=FALSE, fig.cap="Level 1 Report."}
knitr::include_graphics("figures/toolbox/tool_Report-L1.png")
```


#### `Report - L2 Estimate Bankfull`

```{r echo=FALSE, fig.cap="Map - Reach Overview Tool."}
knitr::include_graphics("figures/toolbox/tool_Report-L2_Estimate_Bankfull.png")
```

#### `Report - L2`

```{r echo=FALSE, fig.cap="Level 2 Report."}
knitr::include_graphics("figures/toolbox/tool_Report-L2.png")
```


#### `Report - L3`

```{r echo=FALSE, fig.cap="Level 3 Report."}
knitr::include_graphics("figures/toolbox/tool_Report-L3.png")
```


### 04 - Symbology toolset
The purpose of this toolset is to hold the tools that standardize the symbolization of FluvialGeomorph datasets. Given the complexity of the datasets involved in this analysis

#### `Banklines`

#### `Contibuting Area`

#### `Cross Section`

#### `DEM`

#### `Features`

#### `Flowline`

#### `Flowline Points`

#### `Loop Points`

#### `Valleyline`




### 05 - Check toolset
The purpose of this toolset is to hold the tools used to check FluvialGeomorph features for errors. 

#### `Check ArcGIS Pro Compatibility`

#### `Check Bankline Points`

#### `Check Banklines`

#### `Check Cross Section Points`

#### `Check Cross Section`

#### `Check Faetures`

#### `Check Flowline`

#### `Check Flowline Points`

#### `Check Loop Points`

#### `Check Valleyline`

#### `Check valleyline Points`



### 06 - Export toolset
The purpose of this toolset is to export the tabular data from geospatial datasets for further analysis. 

#### `Level 1`

#### `Level 2`

#### `Level 3`



***

## Feature Classes
FluvialGeomorph defines a standard set of feature classes that are used through the tool chain. The definition of a common set of derived features is an important step in standardizing the FluvialGeomorph workflow. These database objects form a tightly linked set of features that work together in a particular order to accomplish the analysis. They are presented here in the approximate order in which they are produced. 

### Terrain Model Raster
The GIS analyst uses standard ESRI geoprocessing tools to transform a LiDAR point cloud dataset covering the study area into an appropriately resolute (pixel cell size) digital elevation model (DEM). Only points representing the ground or water surface are selected from the point cloud to derive the terrain surface DEM. This raster dataset is named `dem`, but can also have a suffix added to represent its year of collection in change studies. 

```{r, echo=FALSE}
dd_table(dd_df, "stream_network_points", "DEM Raster Pixel Values.")
```

### Cutlines
The `cutlines` polyline feature class is used to store geometry needed to hydrologically modify a terrain model to ensure that water can accurately flow over the land surface as it does in the real world. LiDAR derived terrain models frequently contain flow blockages (e.g., road berms) that must be "cut-through" to represent the presence of flow structures (e.g., culverts, bridges) that cannot be resolved directly from the LiDAR terrain model. 

```{r echo=FALSE}
dd_table(dd_df, "cutlines", "Cutlines Fields.")
```

### Hydro-Modified Raster
Before the `dem` terrain model raster can be used for synthetically deriving stream features, it must first be hydrologically modified using the `cutlines` feature class to "burn" flow paths into the `dem` raster. This "hydro-enforced" DEM is named `dem_hydro`. 

```{r, echo=FALSE}
dd_table(dd_df, "dem_hydro", "Hydro DEM Raster Pixel Values.")
```

### Contributing Area Raster
The `dem_hydro` raster dataset is used to create a `contributing_area` raster whose values store the drainage area upstream of each pixel. 

```{r, echo=FALSE}
dd_table(dd_df, "contributing_area", "Contributing Area Raster Pixel Values.")
```

### Stream Network
The `contributing_area` raster dataset is used to derive a synthetic `stream_network` polyline feature class representing the stream network of the study area. 

```{r, echo=FALSE}
dd_table(dd_df, "stream_network", "Stream Network Fields.")
```

### Stream Network Points
The `stream_network_points` point feature class is used to represent regularly spaced points along a `stream_network` feature class. These `stream_network_points` features are used to store elevation and route position (longitudinal stream stationing) information for a `stream_network` feature. `stream_network_points` are used to calculate several stream longitudinal dimensions. 

```{r, echo=FALSE}
dd_table(dd_df, "stream_network_points", "Stream Network Points Fields.")
```
### Watershed Points
The `watershed_points` point feature class is used to represent the downstream location of watersheds whose areal extent is to be calculated. These single points are sometimes referred to as "pour points" located along a stream network. 
```{r, echo=FALSE}
dd_table(dd_df, "watershed_points", "Watershed Points Fields.")
```

### Watershed
The `watershed` polygon feature class is used to represent the upstream drainage area of a single point (aka "pour point") located along a stream network. All pixels within each `watershed` polygon feature flow to the stream network point used to derive the watershed. 

```{r, echo=FALSE}
dd_table(dd_df, "watershed", "Watershed Fields.")
```

### Flowline
The `flowline` polyline feature class is used to represent the likely flow path of a stream reach within a study area. This is the primary flow path feature used in the FluvialGeomorph toolbox. Since non-bathymetric LiDAR is often used to derive `flowline` features, this should not be interpreted as the thalweg when water is present in the DEM.  

```{r, echo=FALSE}
dd_table(dd_df, "flowline", "Flowline Fields.")
```

### Flowline Points
The `flowline_points` point feature class is used to represent regularly spaced points along a `flowline` feature class. These `flowline_points` features are used to store elevation and route position (longitudinal stream stationing) information for a `flowline` feature. `flowline_points` are used to calculate a series of stream longitudinal dimensions. 

```{r, echo=FALSE}
dd_table(dd_df, "flowline_points", "Flowline Points Fields.")
```

### Detrended Raster
The `detrend` raster dataset is an elevation model where the downstream slope of the `dem_hydro` has been removed. 

```{r, echo=FALSE}
dd_table(dd_df, "detrend", "Hydro DEM Raster Pixel Values.")
```

### Channel Slope Raster
The `channel_slope` raster represents the slope of the `dem_hydro` within the channel. This is not to be confused with the longitudinal slope of the stream reach, but is the pixel-wise, raster surface slope of the channel area. 

```{r, echo=FALSE}
dd_table(dd_df, "channel_slope", "Channel Slope Raster Pixel Values.")
```

### Regular Cross Sections
Cross sections are polyline feature classes drawn perpendicular to the `flowline` feature and are long enough to extend across some portion of the channel and floodplain. Cross section features are used to define channel cross section dimensions. Regular cross sections are created using a tool and spaced equal distances longitudinally along the `flowline`. Regularly spaced cross sections are used to sample conditions within a stream reach to either display a continuous series of values or calculate aggregate stream values. 

Regular cross sections are used during 

```{r, echo=FALSE}
dd_table(dd_df, "xs", "Regular Cross Section Fields.")
```

### Riffle Cross Sections
Riffle cross sections are a unique type of cross section drawn within a riffle stream feature. In contrast to regularly spaced cross sections that are delineated by a script, riffles irregularly spaced along a stream and are manually drawn by a GIS analyst. Analysts are trained to identify riffles using a set of guidelines from the literature and interpretation of the DEM and aerial imagery. The `riffle_floodplain` polyline feature class is drawn longitudinally within riffle features and extend laterally across the active floodplain. The `riffle_channel` polyline feature class is also drawn longitudinally within riffle features, but only extend laterally across the bankfull channel area. 

```{r, echo=FALSE}
dd_table(dd_df, "riffle_floodplain", "Riffle Floodplain Riffle Channel Cross Section Fields.")
```

### Cross Section Points
Cross sections polyline feature classes (i.e., regularly spaced cross sections and riffle cross sections: `riffle_floodplain`, `riffle_channel`) can be converted to a set of regularly spaced points along the cross section. These points are used to store elevation and route position (lateral stream stationing) information for a cross section feature class. Cross section points are used to calculate a series of cross section dimensions. 

```{r, echo=FALSE}
dd_table(dd_df, "xs_points", "Cross Section Points Fields.")
```

### Cross Section Dimensions
Cross section dimension polyline feature classes are used to store the hydraulic dimensions calculated for each cross section. Since the FluvialGeomorph workflow is divided into three levels, cross section dimensions are calculated at each level. Each level allows for an increasingly complex set of dimensions to be calculated, with each level building on the complexity of the previous level.  There are three cross section dimension feature classes, one for each level `*_dims_L1`, `*_dims_L2`, and `*_dims_L3`. Cross section dimensions are calculated using the following tools:

* **Level 1 Dimensions** - The [`15a XS Dimensions, Level 1`](#a---xs-dimensions-level-1) tool creates the `*_dims_L1` feature class. 
* **Level 2 Dimensions** - The [`15b XS Dimensions, Level 1`](#b---xs-dimensions-level-2) tool creates the `*_dims_L2` feature class. 
* **Level 3 Dimensions** - The [`15c XS Planform, Level 1`](#c---xs-planform-level-3) tool creates the `*_dims_L3` feature class. 

Cross section dimensions can be calculated for the various types of cross sections (regular cross sections or riffle cross sections). The name of the cross section feature for which dimensions were calculated is prepended to the output dimension feature class. Metrics calculated at previous levels are included in the attribute table of each dimension feature class. Therefore, to avoid repetition only the new fields calculated at each level are included in the tables of fields in this section. The attributes of the original cross section feature class are also omitted since they depend on the cross section type used. 

```{r, echo=FALSE}
dd_table(dd_df, "_dims_L1", "Level 1 Cross Section Dimension Fields.")
```

```{r, echo=FALSE}
dd_table(dd_df, "_dims_L2", "Level 2 Cross Section Dimension Fields.")
```

```{r, echo=FALSE}
dd_table(dd_df, "_dims_L3", "Level 3 Cross Section Dimension Fields.")
```

### Bankfull Area
The `bankfull_area` polygon feature class represents the channel area typically inundated during bankfull events. The `detrend` raster dataset is used to "flood" the channel to define this extent. 

### Banklines
The `banklines` polyline feature class represents the stream banks at bankfull. The edge of the `bankfull_area` polygon features are used to create to banklines, one representing the left descending bank and another the right descending bank. 

### Bankline Points
The `bankline_points` point feature class is a set of regularly spaced point features located along each `banklines` feature. These points are used to store elevation and route position (longitudinal bankline stationing) information for each bankline. 

### Centerline
The `centerline` polyline feature class is used to represent a stream flow path that fally roughly equidistant between the banklines at bankfull. 

### Valleyline
The `valleyline` polyline feature class represents the trend line of the down-valley axis. It bisects stream meanders as the stream swings from side to side across its floodplain. 

### Loop Points
The `loop_points` point feature class is used to store the longitudinal extents of loops and bends used for planform analysis. Within the FluvialGeomorph toolbox, the term "loop" is defined as a single meander as it swings across the `valleyline`. Moving downstream along a single loop, once the stream swings substantially across the valleyline, another loop begins. The point of maximum distance of a flowline from the valeyline (laterally across the floodplain) defines a loop "apex". Moving to a finer scale, "bends" are defined as stream undulations within a particular loop. Therefore, a single loop may contain many bends. These loop and bend extents and loop apices are used to calculate a set of planform dimensions. 

### Features
The `features` point feature class is used to identify and label key stream features and their longitudinal position. Instances of features typically include relevant tributaries, localities, and infrastructure built within the floodplain affecting flow. 


***

## Reports
FluvialGeomorph produces a series of reports that help to define stream conditions. 

### `Graph - Longitudinal Profile Compare`

```{r echo=FALSE, fig.cap="Longitudinal Profile Plot.", out.width="100%"}
knitr::include_graphics("figures/toolbox/Graph-Longitudinal_Profile_Compare.png")
```

### `Report - L1`
The purpose of this tool is produce the Level 1 report. This ArcGIS script tool 


```{r echo=FALSE, fig.cap="Level 1 Report.", out.width="100%"}
knitr::include_graphics("figures/toolbox/Report_L1.png")
```

### `Report - L2 Estimate Bankfull`

```{r echo=FALSE, fig.cap="Level 2, Estimate Bankfull Report.", out.width="100%"}
knitr::include_graphics("figures/toolbox/Report_L2_Estimate_Bankfull.png")
```

### `Report - L2`

```{r echo=FALSE, fig.cap="Level 2 Report.", out.width="100%"}
knitr::include_graphics("figures/toolbox/Report_L2.png")
```

### `Report - L3`

```{r echo=FALSE, fig.cap="Level 3 Report.", out.width="100%"}
knitr::include_graphics("figures/toolbox/Report_L3.png")
```


***

## Tables, Graphs, and Figures
FluvialGeomorph reports are composed of a standard set of tables, graphs, and figures. 

### Overview Map

### Longitudinal Profile

two types: flowline_points, regular cross section

### Cross Section Metrics

level 1, level 2, level 3

### Cross Section Profile


